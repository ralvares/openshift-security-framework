
== 2. Onboarding Workflow

This workflow describes how new application namespaces are onboarded and network security is enforced using AdminNetworkPolicies (ANP) and BaselineAdminNetworkPolicy (BANP).

=== Step 1 - Developer Requests a Project

The developer submits a request that includes:

- Application name
- Team/owner
- Namespace name(s) required
- Whether the application requires:
  - kube-API access (for operators, migrations, etc.)
  - egress to corporate networks (for external APIs)

Requests follow the organization's standard intake workflow (ServiceNow, Jira, internal portal, etc.).

=== Step 2 - Platform Team Creates the Namespace

The Platform Team creates the project/namespace using the approved template. The following label is always applied:

[source,yaml]
----
business.workload/owned=true
----

This ensures the namespace is included in the ANP/BANP perimeter and all sensitive flows are denied by default.

=== Step 3 - Platform Team Applies Baseline Objects

The following baseline objects are added:

- ResourceQuotas
- LimitRanges
- Default deny-all (if using namespace NP)
- Optional templates: ConfigMaps, RBAC, service accounts
- NetworkPolicy scaffolding (if provided)

=== Step 4 - Security Reviews Special Network Requirements

If the developer requests kube-API access or corporate egress, Security reviews the request. If approved, Security/Platform applies the appropriate label to the namespace:

- `security.allow/kapi: "true"` for kube-API egress
- `security.allow/networks: "true"` for corporate egress

No label or request is needed for monitoring scrapes: ingress from `openshift-monitoring` and `openshift-user-workload-monitoring` is always allowed by policy for all owned namespaces.

=== Step 5 - Security/Platform Updates AdminNetworkPolicies

Security/Platform updates the AdminNetworkPolicy suite as needed:

- Monitoring ingress is always allowed from monitoring namespaces
- DNS egress is always allowed to `openshift-dns`
- Kube-API egress is allowed only for namespaces with the correct label
- Corporate egress is allowed only for namespaces with the correct label
- All other ingress/egress is denied by default

BANP enforces default deny between owned namespaces unless allowed by a higher-tier ANP.

=== Step 6 - Developer Deploys Applications

Developers deploy workloads (Deployments, StatefulSets, CronJobs, Services, Routes, etc.) and create their own NetworkPolicies to define pod-to-pod connectivity within their namespace.

The AdminNetworkPolicy suite enforces the perimeter and ensures that even if developers misconfigure policies (e.g., allow-all), the cluster boundary remains secure.

=== Step 7 - Optional: Changes to Namespace Behavior

If application requirements change (e.g., need for kube-API or corporate egress), developers submit a modification request. Security/Platform reviews and updates the namespace label and/or AdminNetworkPolicy as needed.
