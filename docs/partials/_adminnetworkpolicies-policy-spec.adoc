
== 3. Administrative Enforcement â€“ ANP Suite

In this environment, only the following AdminNetworkPolicies are present and enforced. Each policy is single-purpose, auditable, and mapped to a specific risk domain.

[cols="1,3,1",options="header"]
|===
| File
| Purpose
| Priority

| `corporate-external-networks-guardrail.yaml`
| Allow egress to specific corporate external networks for approved namespaces
| 12

| `kubeapi-egress-guardrail.yaml`
| Permit kube-API access only for explicitly approved workloads
| 13

| `deny-all-allow-dns-owned-namespaces.yaml`
| Default deny for all, allow DNS and pass traffic between owned namespaces
| 99
|===

Each file has one intent, one risk domain, one owner, one approval workflow.

=== 3.1 Corporate External Networks Guardrail ANP

[source,yaml]
----
apiVersion: policy.networking.k8s.io/v1alpha1
kind: AdminNetworkPolicy
metadata:
  name: corporate-access-external-networks-guardrail
spec:
  priority: 12
  subject:
    namespaces:
      matchLabels:
        security.allow/networks: "true"
  egress:
    - name: allow-corporate-external-networks
      action: Allow
      to:
        - networks:
            - XX.XX.XX.0/24
      ports:
        - portNumber:
            protocol: TCP
            port: 443
----

=== 3.2 Kube API Egress Guardrail ANP

[source,yaml]
----
apiVersion: policy.networking.k8s.io/v1alpha1
kind: AdminNetworkPolicy
metadata:
  name: kubeapi-egress-guardrail
spec:
  priority: 13
  subject:
    namespaces:
      matchLabels:
        security.allow/kapi: "true"
  egress:
    - name: allow-kubeapi-for-approved-workloads
      action: Allow
      to:
        - nodes:
            matchExpressions:
              - key: node-role.kubernetes.io/control-plane
                operator: Exists
      ports:
        - portNumber:
            protocol: TCP
            port: 6443
----

=== 3.3 Deny-All, Allow DNS & Monitoring, and Pass for Owned Namespaces ANP

[source,yaml]
----
apiVersion: policy.networking.k8s.io/v1alpha1
kind: AdminNetworkPolicy
metadata:
  name: deny-all-allow-dns-monitoring-owned-namespaces
spec:
  priority: 99
  subject:
    namespaces:
      matchLabels:
        business.workload/owned: "true"
  ingress:
    - name: allow-openshift-monitoring
      action: Allow
      from:
        - namespaces:
            matchLabels:
              kubernetes.io/metadata.name: openshift-monitoring

    - name: allow-user-workload-monitoring
      action: Allow
      from:
        - namespaces:
            matchLabels:
              kubernetes.io/metadata.name: openshift-user-workload-monitoring

    - name: pass-from-owned-namespaces
      action: Pass
      from:
        - namespaces:
            matchLabels:
              business.workload/owned: "true"

    - name: deny-ingress
      action: Deny
      from:
        - namespaces: {}
  egress:
    - name: allow-dns
      action: Allow
      to:
        - namespaces:
            matchLabels:
              kubernetes.io/metadata.name: openshift-dns
      ports:
        - portNumber:
            port: 53
            protocol: UDP
        - portNumber:
            port: 53
            protocol: TCP
        - portNumber:
            port: 5353
            protocol: UDP
        - portNumber:
            port: 5353
            protocol: TCP
    
    - name: pass-to-owned-namespaces
      action: Pass
      to:
        - namespaces:
            matchLabels:
              business.workload/owned: "true"

    - name: deny-egress
      action: Deny
      to:
        - networks:
            - 0.0.0.0/0
----

These are the only AdminNetworkPolicies enforced in this environment. All other references or examples have been removed for clarity and accuracy.
